---
title: "problem set 1 - group 4"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Problem 1

# Problem 2
Iyer (2010) is interested in the effect of direct rule by the British during the colonial period on public goods provision in India, compared to indirect rule through native or "princely" states. Lord Dalhousie, Governor-General of India from 1848 to 1856, announced that: 

\textit{On all occasions where heirs natural shall fail, the territory should be made to lapse and adoption should not be permitted, excepting in those cases in which some strong political reason may render it expedient to depart from this general rule.}

In other words, districts in which a native ruler lacking an heir died during the period of Dalhousie’s rule should be annexed by the British, according to this “Doctrine of Lapse” policy. Iyer argues that the death of an heirless ruler in the period of Dalhousie’s rule can be used as an instrumental variable for direct colonial rule.

(a) What two groups of units would you compare when doing an intent-to-treat analysis here? Numerically, how is intent-to-treat analysis related to instrumental-variables analysis?

For an intent to treat analysis, we would use the variable that is purportedly "as good as random" for the treatment assignment variable, in this case the death of an heirless ruler in the period of Dalhousie's rule. The outcome variable is public goods provision. We would compare the (public good provisions of) the group of units where there was a death of a native ruler without an heir, to the group of units where there was not a death of native ruler or where there was the death of one, but there was an heir.

Here, the instrumental-variables analysis is equivalent to the CACE (in the bivariate, binary treatment case). Numerically, the intent-to-treat analysis is the numerator of this.

(b) Define Compliers, Always-Treats, Never-Treats, and Defiers in this context.

Compliers: Those units where the native ruler died without an heir, and British direct rule was taken up. Those units where the native ruler died with an heir (or where there was no death of the ruler), and British direct rule was not imposed - it remained a princely state.

Always-Treats: Those units where the native ruler died without an heir, and British direct rule was taken up. Those units where the native ruler died with an heir (or where there was no death of the ruler), and British direct rule was taken up.

Never-Treats: Those units where the native ruler died without an heir, and British direct rule was not taken up. Those units where the native ruler died with an heir (or where there was no death of the ruler), and British direct rule was not imposed - it remained a princely state.

Defiers: Those units where the native ruler died without an heir, and British direct rule was not taken up. Those units where the native ruler died with an heir (or where there was no death of the ruler), and British direct rule was imposed.

(c) List the assumptions that are required to estimate a Complier average causal effect.
In this context, which of those assumptions seem plausible (if any), and which seem
suspect (if any)? Could you use any empirical methods to evaluate their plausibility?

There are 5 assumptions required to estimate a Complier average causal effect.

1. SUTVA (non-interference) 
2. random assignment to treatment and control 
3. potential outcomes are fixed attributes of each unit
4. exclusion restriction 
5. no defier types 
6. there are compliers, always takers, and never takers

SUTVA seems plausible. It is unlikely that the death of a ruler (without an heir) would affect the treatment status or outcome of a neighboring district. We could test this by a placebo test wherein we examine whether the death of an heirless ruler in a district affects the outcome of a neighboring district. 

Random assignment of death of a ruler (without an heir) seems plausibly as-if random. Death seems like it strikes exogenously (aka not according to a clear pattern differentiated by districts). We could test this empirically with a balance test and an F statistic on pre-treatment covariates.

Potential outcomes seem to be a good way to think about this problem, and it is feasible to think about them as fixed attributes of a unit, as in the Neyman model. We can't test this. 

Exclusion restriction seems broadly plausible. Yet, we could think of ways in which it could be challenged. For example, if princely states where there are no heirs (and the ruler dies) are those places in which mortality levels were higher (and thus the heirs died) because of bad development conditions, and that this could have long-term effects on the public goods outcomes of the district. We can't test this assumption, but have to reason it theoretically and substantively.

No defier types seems a reasonable assumption. This would mean that in places where the ruler died without an heir, the British didn't take over; and where there was no death or where there was an heir, the British did take over. We can't test this assumption. 

It seems plausible to have compliers, always takers, and never takers. We can't test this assumption however. 

(d) In some of her analyses, Iyer compares districts in which heirless rulers died during Dalhousie’s rule to the remaining districts. Propose a design modification that could
increase the plausibility of the assumptions you described in (c) and say how it does so.

A design modification could be to compare only the districts in which the ruler died (group 1: with heir; group 2: without heir), and exclude the districts where no death occurred. This might be sensible because districts where rulers are dying might be substantively different from those where they're not, in important ways that affect outcomes (like in mortality rates). As stated above, this could have challenges for the feasibility of the exclusion restriction. Thus, restricting the comparison only to districts with similar levels of deaths of rulers would increase our belief in this assumption.

# Problem 3

# Problem 4

# Problem 5
(a) The decline cannot readily be attributed to the effects of the new law. There are likely other events that happened during the time period that may affect the outcome of voting. Further, the law is not implemented as-if randomly across districts - it is implemented according to the level of poverty in an area. There could be important confounding variables with the level of poverty and voting. 

(b) Intention to treat analysis. 

```{r}
# There are 2000 units assigned to control, 75 percent have a value of 1 
# There are 2000 units assigned to treatment, 75.25 % have a value of 1

treatment <- c(rep(1,2000), rep(0, 2000))

outcome <- c(rep(1,1500), rep(0, 500), rep(1, 1505), rep(0, 495))

data <- cbind(treatment, outcome)

ITT <- function(treatment, outcome){
  
  mean_control <- mean(outcome[treatment == 0])
  mean_treatment <- mean(outcome[treatment == 1])
  itt <- mean_treatment - mean_control
  
  #standard error
  treated <- outcome[treatment == 1]
  var1 <- sum((treated - mean(treated))^2) / (length(treated) - 1)
  
  not_treated <- outcome[treatment == 0]
  var0 <- sum((not_treated - mean(not_treated))^2) / (length(not_treated) - 1)
  
  #se_itt
  se_itt <- sqrt((var1/length(treated)) + var0/length(not_treated))
  
  # t stat
  t_stat <- itt / se_itt
  
  df <- (var1/length(treated) + var0/length(not_treated))^2 /
((var1/length(treated))^2 / (length(treated) - 1) +
(var0/length(not_treated))^2 / (length(not_treated) - 1))
  
  # p value
  p_value <- pt(-abs(t_stat), df = df, ncp = 0, lower.tail = TRUE) + 
    pt(abs(t_stat), df = df, ncp = 0, lower.tail = FALSE)
  
  return(c("ITT" = itt, "SE ITT" = se_itt, "p-value" = p_value))
}

itt <- ITT(treatment, outcome)

print(itt)
```
We find that the intention to treatment analysis gives an estimate of -0.0025, and that the effect is not statistically different from 0. 

(c) Treatment receipt is "learning about the lower level of the fine." 

(d) Conduct IV analysis to estimate the complier average causal effect. Also, estimate the turnout (percentage voting) among Compliers in the control group.

(e) List the assumptions necessary for the IV analysis. 

# Problem 6


